<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14.02</title>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Georgia', serif;
            background: radial-gradient(ellipse at bottom, #0a0c18 0%, #000000 100%);
            color: white;
            transition: background 2s ease;
        }


        /* üåå —Å–ª–æ–π –∑–≤—ë–∑–¥ */
        #starfield {
            position: fixed;
            width: 120%;
            height: 120%;
            top: -10%;
            left: -10%;
            z-index: 0;
            transition: transform 0.2s ease-out;
        }



        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: twinkle linear infinite;
            transition: transform 0.4s ease-out;

        }

        @keyframes twinkle {
            0% {
                opacity: 0.2;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.2;
            }
        }

        /* üå† –ø–∞–¥–∞—é—â–∞—è –∑–≤–µ–∑–¥–∞ */
        .shooting-star {
            position: fixed;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 12px white, 0 0 25px white;
            z-index: 1;
        }

        .shooting-star::after {
            content: "";
            position: absolute;
            width: 120px;
            height: 2px;
            top: 50%;
            left: -120px;
            transform: translateY(-50%);
            background: linear-gradient(to right,
                    rgba(255, 255, 255, 0.8),
                    rgba(255, 255, 255, 0));
        }

        .container {
            position: fixed;
            top: 5%;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2;
        }


        .text {
            font-size: clamp(28px, 6vw, 64px);
            min-height: 15vh;
            width: 100%;
            text-align: center;
            transition: opacity 0.25s ease;
        }


        .glow {
            color: #ffd1f0;
            text-shadow:
                0 0 20px #ff6bb5,
                0 0 40px #ff1493,
                0 0 80px #ff1493;
            animation: pulseGlow 2s infinite;
        }

        @keyframes pulseGlow {
            0% {
                text-shadow: 0 0 20px #ff6bb5;
            }

            50% {
                text-shadow: 0 0 60px #ff1493;
            }

            100% {
                text-shadow: 0 0 20px #ff6bb5;
            }
        }

        .heart {
            display: block;
            font-size: 22vw;
            margin-top: 20px;
            opacity: 0;
            animation: beat 1s infinite;
            filter: drop-shadow(0 0 25px #ff4da6);
        }

        @keyframes beat {
            0% {
                transform: scale(1);
            }

            15% {
                transform: scale(1.35);
            }

            30% {
                transform: scale(1);
            }

            45% {
                transform: scale(1.25);
            }

            60% {
                transform: scale(1);
            }

            100% {
                transform: scale(1);
            }
        }

        .start-screen {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5vw;
            opacity: 0.8;
            cursor: pointer;
            z-index: 3;
        }


        #starfield-back,
        #starfield-front {
            position: fixed;
            width: 1000%;
            height: 1000%;
            top: 0%;
            left: 0;
            z-index: 0;
        }

        #starfield-front {
            z-index: 1;
        }

        .streak {
            position: fixed;
            width: 12px;
            height: 2px;
            background: linear-gradient(to right,
                    rgba(255, 255, 255, 0.8),
                    rgba(255, 255, 255, 0));
            border-radius: 2px;
            pointer-events: none;
            z-index: 1;
        }

        #final-sequence {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 5;
        }

        #sequence-img {
            width: 180px;
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        #sequence-img:hover {
            transform: scale(1.05);
        }

        #final-form {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #final-form input {
            padding: 10px;
            border-radius: 10px;
            border: none;
            outline: none;
        }

        #final-form button {
            padding: 10px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            background: #ff4da6;
            color: white;
        }


        #constellation-text {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            color: white;
        }

        .constellation-star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle linear infinite;
            box-shadow: 0 0 6px white;
        }

        .constellation-star.big {
            box-shadow: 0 0 12px white, 0 0 20px #ff6bb5;
        }

        .constellation-line {
            position: absolute;
            height: 1px;
            background: rgba(255, 255, 255, 0.6);
            transform-origin: left center;

            transform: scaleX(0);
            animation: drawLine 1.2s ease forwards;
        }

        @keyframes drawLine {
            from {
                transform: scaleX(0);
                opacity: 0;
            }

            to {
                transform: scaleX(1);
                opacity: 1;
            }
        }

        @keyframes starFloat {
            0% {
                transform: translate(0, 0);
            }

            50% {
                transform: translate(0.8px, -0.8px);
            }

            100% {
                transform: translate(0, 0);
            }
        }

        .constellation-star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation:
                twinkle linear infinite,
                starFloat 3s ease-in-out infinite;
        }

        .constellation-line {
            position: absolute;
            height: 1px;
            background: rgba(255, 255, 255, 0.4);
            transform-origin: left center;
            opacity: 0;
            animation: lineFade 1.2s ease forwards;
        }

        @keyframes lineFade {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        #center-stage {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 25px;
            z-index: 20;
            transform: translateY(-15%);
        }

        #center-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #center-form input {
            padding: 10px;
            border-radius: 10px;
            border: none;
        }

        #center-form button {
            padding: 10px;
            border-radius: 10px;
            border: none;
            background: #ff4da6;
            color: white;
            cursor: pointer;
        }

        html,
        body {
            height: 100%;
            min-height: 100dvh;
        }

        .explosion-star {
            position: fixed;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 8px white, 0 0 15px #ff6bb5;
            pointer-events: none;
            z-index: 50;
        }

        #center-step4 {
            width: 380px;
            transform: scale(0.6);
            opacity: 0;
        }

        .step-animate {
            animation: stepAppear 0.8s ease forwards;
        }


        @keyframes stepAppear {
            0% {
                transform: scale(0.6);
                opacity: 0;
            }

            60% {
                transform: scale(1.1);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 1;
                /* ‚Üê –í–ê–ñ–ù–û */
            }
        }


        .fade-out {
            opacity: 0;
            transition: opacity 0.25s ease;
        }

        .constellation-letter {
            display: inline-block;
            position: relative;
            font-weight: bold;
            letter-spacing: 4px;
            color: white;
            text-shadow: 0 0 6px white, 0 0 12px #ff6bb5;
            animation: letterTwinkle 3s ease-in-out infinite;
        }

        @keyframes letterTwinkle {
            0% {
                opacity: 0.7;
                text-shadow: 0 0 6px white, 0 0 12px #ff6bb5;
            }

            50% {
                opacity: 1;
                text-shadow: 0 0 14px white, 0 0 28px #ff6bb5;
            }

            100% {
                opacity: 0.7;
                text-shadow: 0 0 6px white, 0 0 12px #ff6bb5;
            }
        }

        .constellation-letter::after {
            content: "‚Ä¢";
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 10px;
            opacity: 0.6;
        }

        .word-star {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 8px white, 0 0 15px #ff6bb5;
            opacity: 0;
            animation: starAppear 0.6s ease forwards;
        }

        @keyframes starAppear {
            from {
                opacity: 0;
                transform: scale(0.2);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .word-line {
            position: absolute;
            height: 1px;
            background: rgba(255, 255, 255, 0.5);
            transform-origin: left center;
            opacity: 0;
        }

        .word-letter {
            position: absolute;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 8px white, 0 0 20px #ff6bb5;
            opacity: 0;
        }

        @keyframes wordTwinkle {
            0% {
                opacity: 0.7;
                text-shadow: 0 0 6px white, 0 0 12px #ff6bb5;
            }

            50% {
                opacity: 1;
                text-shadow: 0 0 14px white, 0 0 28px #ff6bb5;
            }

            100% {
                opacity: 0.7;
                text-shadow: 0 0 6px white, 0 0 12px #ff6bb5;
            }
        }

        @keyframes letterFade {
            to {
                opacity: 1;
            }
        }

        .dust {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            box-shadow: 0 0 6px white;
        }

        .word-star {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 8px white, 0 0 15px #ff6bb5;
        }

        .word-line {
            position: absolute;
            height: 1px;
            background: rgba(255, 255, 255, 0.6);
            transform-origin: left center;
            opacity: 0;
        }

        #constellation-box {
            margin-top: 40px;
            width: 320px;
            height: 280px;
            position: relative;

            transform-origin: center center;
        }

        @keyframes heartBreath {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.04);
            }

            100% {
                transform: scale(1);
            }
        }
    </style>
</head>

<body>

    <div id="starfield-back"></div>
    <div id="starfield-front"></div>


    <div class="start-screen" onclick="startExperience()">
        —Ç—ã–∫ üí´
    </div>

    <div class="container" id="main" style="display:none;">
        <div id="text" class="text"></div>
        <span id="heart" class="heart">üíó</span>
    </div>

    <audio id="spaceSound" loop>
        <source src="magic.mp3">
    </audio>

    <audio id="typeSound1">
        <source src="typewriter-1.mp3">
    </audio>

    <audio id="typeSound2">
        <source src="typewriter-2.mp3">
    </audio>

    <audio id="starSound">
        <source src="sparkle.mp3">
    </audio>

    <div id="final-sequence" style="display:none;">
        <img id="sequence-img" src="step1.png">
    </div>

    <div id="center-stage" style="display:none;">
        <img id="center-step4" src="step4.png">

        <div id="center-form">
            <input id="love-input" type="text" placeholder="–ö–æ–¥ üíó">
            <button id="love-button">–¢—ã–∫</button>
        </div>

        <div id="constellation-box">
            <div id="constellation-text"></div>
        </div>
    </div>

    <script>

        const textElement = document.getElementById("text");
        const heart = document.getElementById("heart");
        const starfield = document.getElementById("starfield");
        const spaceSound = document.getElementById("spaceSound");
        const typeSound1 = document.getElementById("typeSound1");
        const typeSound2 = document.getElementById("typeSound2");
        const starSound = document.getElementById("starSound");
        const clickSound = typeSound2;


        const messages = [
            "—Ç–µ–∫—Å—Ç 1",
            "—Ç–µ–∫—Å—Ç2222222",
            "—Ç–µ–∫—Å—Ç 3333333333333"
        ];

        let messageIndex = 0;
        let charIndex = 0;
        let soundToggle = true;
        let heartbeatInterval = null;

        /* ‚≠ê —Å–æ–∑–¥–∞—ë–º –∑–≤—ë–∑–¥—ã */
        const starfieldBack = document.getElementById("starfield-back");
        const starfieldFront = document.getElementById("starfield-front");

        function createStars() {

            // –¥–∞–ª—å–Ω–∏–π —Å–ª–æ–π
            for (let i = 0; i < 140; i++) {
                const star = document.createElement("div");
                star.classList.add("star");

                const size = Math.random() * 2 + 0.5;

                star.style.width = size + "px";
                star.style.height = size + "px";
                star.style.left = Math.random() * 200 + "vw";
                star.style.top = Math.random() * 100 + "vh";
                star.style.animationDuration = (Math.random() * 3 + 2) + "s";

                starfieldBack.appendChild(star);
            }

            // –±–ª–∏–∂–Ω–∏–π —Å–ª–æ–π
            for (let i = 0; i < 60; i++) {
                const star = document.createElement("div");
                star.classList.add("star");

                const size = Math.random() * 3 + 1.5;

                star.style.width = size + "px";
                star.style.height = size + "px";
                star.style.left = Math.random() * 200 + "vw";
                star.style.top = Math.random() * 100 + "vh";
                star.style.animationDuration = (Math.random() * 2 + 1) + "s";

                starfieldFront.appendChild(star);
            }
        }


        createStars();

        /* üåå –ü–ª–∞–≤–Ω—ã–π –¥—Ä–µ–π—Ñ */
        let driftX = 0;
        let driftY = 0;
        let parallaxX = 0;
        let parallaxY = 0;

        let driftBack = 0;
        let driftFront = 0;

        let driftBackX = 0;
        let driftBackY = 0;

        let driftFrontX = 0;
        let driftFrontY = 0;

        function driftSpace() {

            driftBackX -= 0.12;
            driftBackY += 0.06;

            driftFrontX -= 0.25;
            driftFrontY += 0.12;

            starfieldBack.style.transform =
                `translate(${driftBackX + parallaxX}px, ${driftBackY + parallaxY}px)`;

            starfieldFront.style.transform =
                `translate(${driftFrontX + parallaxX * 1.5}px, ${driftFrontY + parallaxY}px)`;

            requestAnimationFrame(driftSpace);
        }

        driftSpace();



        /* üì± –ü–∞—Ä–∞–ª–ª–∞–∫—Å */
        function requestGyroPermission() {

            function handleOrientation(event) {
                parallaxX = event.gamma * 0.3;
                parallaxY = event.beta * 0.2;
            }

            if (typeof DeviceOrientationEvent !== "undefined" &&
                typeof DeviceOrientationEvent.requestPermission === "function") {

                DeviceOrientationEvent.requestPermission()
                    .then(response => {
                        if (response === "granted") {
                            window.addEventListener("deviceorientation", handleOrientation);
                        }
                    })
                    .catch(() => { });

            } else {
                window.addEventListener("deviceorientation", handleOrientation);
            }
        }

        /* üöÄ –°—Ç–∞—Ä—Ç */
        function startExperience() {

            document.querySelector(".start-screen").style.display = "none";
            document.getElementById("main").style.display = "flex";


            typeWriter();
            if (typeof DeviceOrientationEvent !== "undefined" &&
                typeof DeviceOrientationEvent.requestPermission === "function") {

                DeviceOrientationEvent.requestPermission()
                    .then(response => {
                        if (response === "granted") {
                            window.addEventListener("deviceorientation", event => {
                                parallaxX = event.gamma * 0.3;
                                parallaxY = event.beta * 0.2;
                            });
                        }
                    })
                    .catch(() => { });
            }

        }

        /* ‚å® –ø–µ—á–∞—Ç–Ω–∞—è –º–∞—à–∏–Ω–∫–∞ */
        function typeWriter() {
            if (charIndex < messages[messageIndex].length) {

                textElement.innerHTML += messages[messageIndex].charAt(charIndex);
                if (
                    (messageIndex === 0 && charIndex === messages[0].length - 1) ||
                    (messageIndex === 2 && charIndex === messages[2].length - 1)
                ) {
                    const video = document.createElement("video");
                    video.src = "kitty.mp4";
                    video.autoplay = true;
                    video.muted = true;
                    video.loop = true;
                    video.playsInline = true;

                    video.style.height = "1em";
                    video.style.verticalAlign = "middle";
                    video.style.marginLeft = "8px";

                    textElement.appendChild(video);
                    videoInserted = true;
                }


                if (soundToggle) {
                    typeSound1.currentTime = 0;
                    typeSound1.play().catch(() => { });
                } else {
                    typeSound2.currentTime = 0;
                    typeSound2.play().catch(() => { });
                }

                soundToggle = !soundToggle;
                charIndex++;

                setTimeout(typeWriter, 90);

            } else {
                setTimeout(nextMessage, 1500);
            }
        }

        function nextMessage() {


            if (messageIndex < messages.length - 1) {

                // –ø–ª–∞–≤–Ω–æ –∏—Å—á–µ–∑–∞–µ–º
                textElement.classList.add("fade-out");

                setTimeout(() => {

                    textElement.innerHTML = "";
                    textElement.classList.remove("fade-out");

                    messageIndex++;
                    charIndex = 0;

                    typeWriter();

                }, 250); // –≤—Ä–µ–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å transition
            } else {

                document.body.style.background =
                    "radial-gradient(ellipse at bottom, #2b0f2f 0%, #000000 100%)";

                textElement.classList.add("glow");
                heart.style.opacity = "1";

                document.body.style.background =
                    "radial-gradient(ellipse at bottom, #2b0f2f 0%, #000000 100%)";

                textElement.classList.add("glow");
                heart.style.opacity = "1";

                // üéµ –∑–∞–ø—É—Å–∫–∞–µ–º magic
                spaceSound.currentTime = 0;
                spaceSound.volume = 0.4;
                spaceSound.play().catch(() => { });

                startStarfall();
                startHeartbeatVibration();

                setTimeout(startFinalSequence, 1);
                // –≤—Ä–µ–º—è –∑–∞–¥–µ—Ä–∂–∫–∏

            }
        }

        /* üå† –∑–≤–µ–∑–¥–æ–ø–∞–¥ */
        function startStarfall() {
            for (let i = 0; i < 6; i++) {
                setTimeout(() => createShootingStar(), i * 300);
            }
        }

        function createShootingStar() {

            const star = document.createElement("div");
            star.classList.add("shooting-star");

            const startY = Math.random() * 40;
            star.style.top = startY + "vh";
            star.style.left = "-10vw";

            document.body.appendChild(star);

            const deltaX = window.innerWidth * 1.2;
            const deltaY = window.innerHeight * 0.4;

            const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);

            star.animate([
                { transform: `translate(0,0) rotate(${angle}deg)` },
                { transform: `translate(${deltaX}px, ${deltaY}px) rotate(${angle}deg)` }
            ], {
                duration: 1200,
                easing: "ease-out"
            });

            setTimeout(() => star.remove(), 1300);
        }

        /* üíì –≤–∏–±—Ä–∞—Ü–∏—è */

        function startHeartbeatVibration() {
            if (!("vibrate" in navigator)) return;

            // –µ—Å–ª–∏ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–Ω–æ–≤–∞
            if (heartbeatInterval) return;

            function beat() {
                navigator.vibrate(120);
                setTimeout(() => navigator.vibrate(80), 300);
            }

            beat();
            heartbeatInterval = setInterval(beat, 1000);
        }

        function softVibrate() {
            if (!("vibrate" in navigator)) return;

            // –æ—á–µ–Ω—å –ª—ë–≥–∫–∞—è –∫–æ—Ä–æ—Ç–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è
            navigator.vibrate(12);
        }



        // üîÑ –ø—ã—Ç–∞–µ–º—Å—è –≤–∫–ª—é—á–∏—Ç—å –ø–∞—Ä–∞–ª–ª–∞–∫—Å —Å—Ä–∞–∑—É

        function initParallaxEarly() {

            function handleOrientation(event) {
                parallaxX = event.gamma * 0.3;
                parallaxY = event.beta * 0.2;
            }

            if (typeof DeviceOrientationEvent !== "undefined" &&
                typeof DeviceOrientationEvent.requestPermission === "function") {

                // iPhone ‚Äî –∂–¥—ë–º –∫–ª–∏–∫–∞
                console.log("iOS detected ‚Äî –ø–∞—Ä–∞–ª–ª–∞–∫—Å –≤–∫–ª—é—á–∏—Ç—Å—è –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è");

            } else {
                // Android ‚Äî —Å—Ä–∞–∑—É —Ä–∞–±–æ—Ç–∞–µ—Ç
                window.addEventListener("deviceorientation", handleOrientation);
            }
        }

        initParallaxEarly();


        function createStreak() {

            const streak = document.createElement("div");
            streak.classList.add("streak");

            const startY = Math.random() * window.innerHeight;
            streak.style.top = startY + "px";
            streak.style.left = "-20px";

            document.body.appendChild(streak);

            const deltaX = window.innerWidth + 40;
            const deltaY = window.innerHeight * 0.25;

            const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);

            streak.style.transform = `rotate(${angle}deg)`;

            streak.animate([
                { transform: `translate(0,0) rotate(${angle}deg)`, opacity: 0.8 },
                { transform: `translate(${deltaX}px, ${deltaY}px) rotate(${angle}deg)`, opacity: 0 }
            ], {
                duration: 600,
                easing: "ease-out"
            });

            setTimeout(() => streak.remove(), 650);
        }

        setInterval(() => {
            if (Math.random() > 0.6) {
                createStreak();
            }
        }, 400);

        function startFinalSequence() {

            const container = document.getElementById("final-sequence");
            const sequenceImg = document.getElementById("sequence-img");
            const finalForm = document.getElementById("final-form");

            container.style.display = "block";

            const images = [
                "step1.png",
                "step2.png",
                "step3.png",
                "step4.png"
            ];

            let currentStep = 0;

            sequenceImg.addEventListener("click", () => {

                // üîä –∑–≤—É–∫
                clickSound.currentTime = 0;
                clickSound.play().catch(() => { });

                // –µ—Å–ª–∏ –º—ã –µ—â–µ –ù–ï –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —à–∞–≥–µ
                if (currentStep < images.length - 1) {
                    currentStep++;
                    sequenceImg.src = images[currentStep];
                    return;
                }

                // üëâ –µ—Å–ª–∏ —É–∂–µ –ø–æ–∫–∞–∑–∞–Ω step4 ‚Äî —Å–ª–µ–¥—É—é—â–∏–π –∫–ª–∏–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ü–µ–Ω—Ç—Ä
                sequenceImg.style.display = "none";

                // —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–∏–Ω–∞–ª
                textElement.style.display = "none";
                heart.style.display = "none";
                spaceSound.pause();

                // –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–∏–±—Ä–∞—Ü–∏—é –ø–æ–ª–Ω–æ—Å—Ç—å—é
                navigator.vibrate(0);
                if (heartbeatInterval) {
                    clearInterval(heartbeatInterval);
                    heartbeatInterval = null;
                }

                // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–Ω—Ç—Ä
                const centerStage = document.getElementById("center-stage");
                const stepImg = document.getElementById("center-step4");

                centerStage.style.display = "flex";

                // –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                stepImg.classList.remove("step-animate");
                void stepImg.offsetWidth;
                stepImg.classList.add("step-animate");

                createHeartConstellation();
            });





        }


        function createHeartConstellation() {

            const box = document.getElementById("constellation-box");
            box.querySelectorAll(".constellation-star, .constellation-line")
                .forEach(el => el.remove());


            const points = 60;
            const scale = 11;

            const starPositions = [];

            for (let i = 0; i < points; i++) {

                const t = (Math.PI * 2 * i) / points;

                const x = 16 * Math.pow(Math.sin(t), 3);
                const y =
                    13 * Math.cos(t)
                    - 5 * Math.cos(2 * t)
                    - 2 * Math.cos(3 * t)
                    - Math.cos(4 * t);

                // —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Ç–æ—á–∫–∏ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ —Å–µ—Ä–¥—Ü–∞
                const distanceFromCenter = Math.sqrt(x * x + y * y);

                // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º (–ø—Ä–∏–º–µ—Ä–Ω–æ 0‚Äì1)
                const normalized = distanceFromCenter / 20;

                // —Å–∏–ª—å–Ω–µ–µ —Ö–∞–æ—Å –ø–æ –∫—Ä–∞—è–º
                // –æ—á–µ–Ω—å –º—è–≥–∫–∏–π –∂–∏–≤–æ–π —Ä–∞–∑–±—Ä–æ—Å
                const jitterStrength = 11 * normalized;

                const jitterX = (Math.random() - 0.5) * jitterStrength;
                const jitterY = (Math.random() - 0.5) * jitterStrength;

                // –±–µ–∑ —Ä–∞–¥–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å–∫–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã
                const posX = 150 + x * scale + jitterX;
                const posY = 120 - y * scale + jitterY;

                const star = document.createElement("div");
                star.classList.add("constellation-star");

                const size = Math.random() * 3 + 2;

                star.style.width = size + "px";
                star.style.height = size + "px";
                star.style.left = posX + "px";
                star.style.top = posY + "px";
                star.style.animationDuration = (Math.random() * 3 + 2) + "s";

                // –∫–∞–∂–¥–∞—è 6-—è –∑–≤–µ–∑–¥–∞ –∫—Ä—É–ø–Ω–µ–µ
                if (i % 6 === 0) {
                    star.classList.add("big");
                    star.style.width = "5px";
                    star.style.height = "5px";
                }

                box.appendChild(star);

                starPositions.push({ x: posX, y: posY });
            }

            // üî• —Ä–∏—Å—É–µ–º –ª–∏–Ω–∏–∏
            for (let i = 0; i < starPositions.length; i++) {

                const next = (i + 1) % starPositions.length;

                const x1 = starPositions[i].x;
                const y1 = starPositions[i].y;

                const x2 = starPositions[next].x;
                const y2 = starPositions[next].y;

                const dx = x2 - x1;
                const dy = y2 - y1;

                const length = Math.sqrt(dx * dx + dy * dy);
                const angle = Math.atan2(dy, dx) * 180 / Math.PI;

                const line = document.createElement("div");
                line.classList.add("constellation-line");

                line.style.width = length + "px";
                line.style.left = x1 + "px";
                line.style.top = y1 + "px";
                line.style.transform = `rotate(${angle}deg)`;

                box.appendChild(line);
            }
        }


        function triggerStarFlash() {

            const stars = document.querySelectorAll(".constellation-star");

            stars.forEach(star => {
                star.style.boxShadow = "0 0 20px white, 0 0 35px #ff6bb5";
                star.style.transform = "scale(1.4)";

                setTimeout(() => {
                    star.style.boxShadow = "0 0 6px white";
                    star.style.transform = "scale(1)";
                }, 500);
            });
        }



        const button = document.getElementById("love-button");

        button.addEventListener("click", () => {

            const input = document.getElementById("love-input")
                .value.trim().toLowerCase();

            const text = document.getElementById("constellation-text");

            clickSound.currentTime = 0;
            clickSound.play().catch(() => { });

            if (input === "—Ç–µ—Å—Ç") {
                renderConstellationTextAdvanced("–æ—Ç–≤–µ—Ç –æ—Ç–≤–µ—Ç");
                triggerStarFlash();
                starExplosion();
                text.style.textShadow =
                    "0 0 20px #ff6bb5, 0 0 40px #ff1493";
            } else {
                text.textContent = "";
            }
        });


        function starExplosion() {

            for (let i = 0; i < 25; i++) {

                const particle = document.createElement("div");
                particle.classList.add("explosion-star");

                particle.style.left = "50%";
                particle.style.top = "50%";

                document.body.appendChild(particle);

                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 120 + 50;

                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;

                particle.animate([
                    { transform: "translate(-50%, -50%) scale(1)", opacity: 1 },
                    { transform: `translate(${x}px, ${y}px) scale(0.2)`, opacity: 0 }
                ], {
                    duration: 900,
                    easing: "ease-out"
                });

                setTimeout(() => particle.remove(), 900);
            }
        }

        function renderConstellationText(message) {

            const container = document.getElementById("constellation-text");
            container.innerHTML = "";

            for (let char of message) {

                const span = document.createElement("span");
                span.classList.add("constellation-letter");

                // –µ—Å–ª–∏ –ø—Ä–æ–±–µ–ª ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
                if (char === " ") {
                    span.innerHTML = "&nbsp;";
                } else {
                    span.textContent = char;
                }

                // –ª—ë–≥–∫–∞—è "–ª–æ–º–∞–Ω–æ—Å—Ç—å"
                const offsetX = Math.random() * 6 - 3;
                const offsetY = Math.random() * 6 - 3;

                span.style.transform = `translate(${offsetX}px, ${offsetY}px) rotate(${Math.random() * 6 - 3}deg)`;
                span.style.animationDuration = (Math.random() * 3 + 2) + "s";
                span.style.animationDelay = (Math.random() * 2) + "s";
                container.appendChild(span);
            }
        }

        function renderConstellationTextAdvanced(message) {

            const box = document.getElementById("constellation-text");
            box.innerHTML = "";

            const startX = 40;
            const startY = 100;
            const spacing = 26;

            const letters = [];

            for (let i = 0; i < message.length; i++) {

                if (message[i] === " ") continue;

                const jitterX = Math.random() * 10 - 5;
                const jitterY = Math.random() * 10 - 5;

                const x = startX + i * spacing + jitterX;
                const y = startY + jitterY;

                letters.push({ x, y, char: message[i] });

                // üå´ —Å–æ–∑–¥–∞—ë–º –ø—ã–ª—å
                for (let d = 0; d < 12; d++) {

                    const dust = document.createElement("div");
                    dust.classList.add("dust");

                    const randomX = Math.random() * 300;
                    const randomY = Math.random() * 200;

                    dust.style.left = randomX + "px";
                    dust.style.top = randomY + "px";

                    box.appendChild(dust);

                    dust.animate(
                        [
                            { opacity: 0, transform: "scale(0.5)" },
                            { opacity: 1 },
                            { left: x + "px", top: y + "px", opacity: 1 }
                        ],
                        {
                            duration: 1200,
                            easing: "ease-out",
                            fill: "forwards"
                        }
                    );
                }
            }

            // üîä –∑–≤—É–∫ –ø–æ—è–≤–ª–µ–Ω–∏—è
            starSound.currentTime = 0;
            starSound.volume = 0.5;
            starSound.play().catch(() => { });

            // ‚ú® —á–µ—Ä–µ–∑ 1.2—Å —Å–æ–∑–¥–∞—ë–º –∑–≤—ë–∑–¥—ã
            setTimeout(() => {

                letters.forEach(letter => {

                    const star = document.createElement("div");
                    star.classList.add("word-star");

                    star.style.left = letter.x + "px";
                    star.style.top = letter.y + "px";

                    box.appendChild(star);
                });

            }, 1200);

            // ‚ú® —á–µ—Ä–µ–∑ 1.6—Å —Ä–∏—Å—É–µ–º –ª–∏–Ω–∏–∏ –∏ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±—É–∫–≤—ã
            setTimeout(() => {

                letters.forEach((letter, i) => {

                    setTimeout(() => {

                        // ---------- –ü–û–ö–ê–ó –ë–£–ö–í–´ ----------
                        const l = document.createElement("div");
                        l.classList.add("word-letter");

                        l.textContent = letter.char;

                        l.style.left = letter.x - 6 + "px";
                        l.style.top = letter.y - 18 + "px";

                        l.animate(
                            [
                                { opacity: 0, filter: "blur(6px)" },
                                { opacity: 1, filter: "blur(0px)" }
                            ],
                            {
                                duration: 500,
                                easing: "ease-out",
                                fill: "forwards"
                            }
                        );

                        box.appendChild(l);
                        softVibrate();

                        // ---------- –†–ò–°–£–ï–ú –õ–ò–ù–ò–Æ (–µ—Å–ª–∏ –Ω–µ –ø–æ—Å–ª–µ–¥–Ω—è—è –±—É–∫–≤–∞) ----------
                        if (i < letters.length - 1) {

                            const x1 = letters[i].x;
                            const y1 = letters[i].y;
                            const x2 = letters[i + 1].x;
                            const y2 = letters[i + 1].y;

                            const dx = x2 - x1;
                            const dy = y2 - y1;

                            const length = Math.sqrt(dx * dx + dy * dy);
                            const angle = Math.atan2(dy, dx) * 180 / Math.PI;

                            const line = document.createElement("div");
                            line.classList.add("word-line");

                            line.style.width = length + "px";
                            line.style.left = x1 + "px";
                            line.style.top = y1 + "px";

                            box.appendChild(line);

                            line.animate(
                                [
                                    { transform: `scaleX(0) rotate(${angle}deg)`, opacity: 0 },
                                    { transform: `scaleX(1) rotate(${angle}deg)`, opacity: 1 }
                                ],
                                {
                                    duration: 400,
                                    easing: "ease-out",
                                    fill: "forwards"
                                }
                            );
                        }

                    }, i * 250); // –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –±—É–∫–≤–∞–º–∏

                });

            }, 2000);

        }

    </script>

</body>


</html>
